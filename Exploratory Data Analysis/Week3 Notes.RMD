---
title: "Week3 Notes.RMD"
output: html_document
---
Hierarchical Clustering

```{r}
#random sets
set.seed(1234)
par(mar= c(0,0,0,0))
x<- rnorm(12, mean= rep(1:3, each=4), sd=0.2)
y<- rnorm(12, mean=rep(c(1,2,1),each=4),sd=0.2)
plot(x,y,col="blue", pch=19, cex=2)
text(x+ 0.05, y+0.05, labels= as.character(1:12))


#Calculate the distance
dataFrame <- data.frame(x=x, y=y)
dist(dataFrame)

#clustering (create a dendrogram)
distxy<- dist(dataFrame)
hClustering <- hclust(distxy)
plot(hClustering)
```

K-means Clustering
```{r}
#Random sets
set.seed(1234)
par(mar= c(0,0,0,0))
x<- rnorm(12, mean= rep(1:3, each=4), sd=0.2)
y<- rnorm(12, mean=rep(c(1,2,1),each=4),sd=0.2)
plot(x,y,col="blue", pch=19, cex=2)
text(x+ 0.05, y+0.05, labels= as.character(1:12))

#kmeans functions
kmeansObj <- kmeans(dataFrame, centers=3)
names(kmeansObj)
kmeansObj$cluster

#plot the data
par(mar=rep(0.2,4))
plot(x,y, col=kmeansObj$cluster, pch=19, cex=2)
points(kmeansObj$centers, col=1:3, pch=3, cex=3, lwd=3)

#alt: heatmap
set.seed(1234)
dataMatrix <- as.matrix(dataFrame)[sample(1:12),]
kmeansObj2 <- kmeans(dataMatrix, centers =3)
par(mfrow=c(1,2), mar= c(2,4,0.1,0.1))
image(t(dataMatrix)[,nrow(dataMatrix):1],yaxt= "n")
image(t(dataMatrix)[,order(kmeansObj$cluster)],yaxt= "n")

```



Principals Componenets Analysis and Singular Value Decomposition (SVD)

SVD:
If X is a matrix with each var in a column and each obs in a row then the SVD is a "matrix decomposition"

X= UDV^T

where the columns of U are orthogonal (left singular vectors), the columns of V are orthogonal (right singular vector) and D is diagonal matrix (singular values)

```{r}
#Data frame
hh<- hclust(dist(dataMatrix))
dataMatrixOrd <- dataMatrix[hh$order,]
par(mfrow=c(1,3))

#COmponenets of the SVD- u and v

svd1 <- svd(scale(dataMatrixOrd))
par(mfrow=c(1,3))
image(t(dataMatrixOrd)[, nrow(dataMatrixOrd):1])

```


