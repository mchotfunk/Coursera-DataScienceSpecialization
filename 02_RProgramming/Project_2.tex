\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Project 2},
            pdfauthor={Andrew Abisha Hu},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Project 2}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Andrew Abisha Hu}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{8/16/2018}


\begin{document}
\maketitle

\subsection{\texorpdfstring{\textbf{Instructions:}}{Instructions:}}\label{instructions}

The Hospital Compare web site contains a lot of data and we will only
look at a small subset for this assignment. The zip file for this
assignment contains three files

• outcome-of-care-measures.csv: Contains information about 30-day
mortality and readmission rates

for heart attacks, heart failure, and pneumonia for over 4,000
hospitals. • hospital-data.csv: Contains information about each
hospital.

• Hospital\_Revised\_Flatfiles.pdf: Descriptions of the variables in
each file (i.e the code book).

A description of the variables in each of the files is in the included
PDF file named Hospital\_Revised\_Flatfiles.pdf.

This document contains information about many other files that are not
included with this programming assignment. You will want to focus on the
variables for Number 19 (\Outcome of Care Measures.csv``) and Number 11
(\Hospital Data.csv''). You may find it useful to print out this
document (at least the pages for Tables 19 and 11) to have next to you
while you work on this assignment. In particular, the numbers of the
variables for each table indicate column indices in each table (i.e.
\Hospital Name" is column 2 in the outcome-of-care-measures.csv file).

\subsection{Part I}\label{part-i}

Write a function called best that take two arguments: the 2-character
abbreviated name of a state and an outcome name. The function reads the
outcome-of-care-measures.csv file and returns a character vector with
the name of the hospital that has the best (i.e.~lowest) 30-day
mortality for the specified outcome in that state. The hospital name is
the name provided in the Hospital.Name variable. The outcomes can be one
of \heart attack``, \heart failure'', or \pneumonia``. Hospitals that do
not have data on a particular outcome should be excluded from the set of
hospitals when deciding the rankings. Handling ties. If there is a tie
for the best hospital for a given outcome, then the hospital names
should be sorted in alphabetical order and the first hospital in that
set should be chosen (i.e.~if hospitals \b'', \c``, and \f'' are tied
for best, then hospital \b" should be returned).

The function should use the following template.

\begin{verbatim}
best <- function(state, outcome) {
## Read outcome data
## Check that state and outcome are valid
## Return hospital name in that state with lowest 30-day death
## rate
}
\end{verbatim}

The function should check the validity of its arguments. If an invalid
state value is passed to best, the function should throw an error via
the stop function with the exact message \invalid state``. If an invalid
outcome value is passed to best, the function should throw an error via
the stop function with the exact message \invalid outcome''.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 3.5.1
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{best <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(state, outcome) \{}
\NormalTok{        ## Read outcome data}
\NormalTok{        data <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"outcome-of-care-measures.csv"}\NormalTok{,}\DataTypeTok{colClasses =} \StringTok{"character"}\NormalTok{) }
        
\NormalTok{        data<-}\StringTok{ }\KeywordTok{select}\NormalTok{(data,}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{17}\NormalTok{,}\DecValTok{23}\NormalTok{)) }\CommentTok{#subset for hospital, state, heart attack, heart failure and pneumonia}
        \KeywordTok{colnames}\NormalTok{(data) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)}
        
        \CommentTok{# Check that state and outcome are valid}
        \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\NormalTok{state }\OperatorTok{%in%}\StringTok{ }\NormalTok{data[ ,}\StringTok{"state"}\NormalTok{])\{ }\KeywordTok{stop}\NormalTok{(}\StringTok{'invalid state'}\NormalTok{)\}}
        \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\NormalTok{outcome }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)) \{}\KeywordTok{stop}\NormalTok{(}\StringTok{'invalid outcome'}\NormalTok{)\} }\CommentTok{#for invalid}
        \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{        state_logical <-}\StringTok{ }\KeywordTok{which}\NormalTok{(data[, }\StringTok{"state"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\NormalTok{state)}
\NormalTok{        df_state <-}\StringTok{ }\NormalTok{data[state_logical, ]    }\CommentTok{# subset data for having state}
\NormalTok{        ot <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(df_state[, }\KeywordTok{eval}\NormalTok{(outcome)])}\CommentTok{#turn the outcome into numeric}
\NormalTok{        min_eval <-}\StringTok{ }\KeywordTok{min}\NormalTok{(ot, }\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{) }\CommentTok{#assign the min value}
\NormalTok{        result  <-}\StringTok{ }\NormalTok{df_state[, }\StringTok{"hospital"}\NormalTok{][}\KeywordTok{which}\NormalTok{(ot }\OperatorTok{==}\StringTok{ }\NormalTok{min_eval)]}
\NormalTok{        output  <-}\StringTok{ }\NormalTok{result[}\KeywordTok{order}\NormalTok{(result)] \}}
\KeywordTok{return}\NormalTok{(output)     }
\NormalTok{\}}
\KeywordTok{best}\NormalTok{(}\StringTok{"SC"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in best("SC", "heart attack"): NAs introduced by coercion
\end{verbatim}

\begin{verbatim}
## [1] "MUSC MEDICAL CENTER"
\end{verbatim}

\subsection{\texorpdfstring{\textbf{Part II}}{Part II}}\label{part-ii}

Ranking hospitals by outcome in a state

Write a function called rankhospital that takes three arguments: the
2-character abbreviated name of a state (state), an outcome (outcome),
and the ranking of a hospital in that state for that outcome (num). The
function reads the outcome-of-care-measures.csv file and returns a
character vector with the name of the hospital that has the ranking
specified by the num argument. For example, the call
rankhospital(``MD'', ``heart failure'', 5) would return a character
vector containing the name of the hospital with the 5th lowest 30-day
death rate for heart failure. The num argument can take values \best``,
\worst'', or an integer indicating the ranking (smaller numbers are
better). If the number given by num is larger than the number of
hospitals in that state, then the function should return NA. Hospitals
that do not have data on a particular outcome should be excluded from
the set of hospitals when deciding the rankings.

The function should use the following template.

\begin{verbatim}
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
## Check that state and outcome are valid
## Return hospital name in that state with the given rank
## 30-day death rate
}
\end{verbatim}

The function should check the validity of its arguments. If an invalid
state value is passed to rankhospital, the function should throw an
error via the stop function with the exact message \invalid state``. If
an invalid outcome value is passed to rankhospital, the function should
throw an error via the stop function with the exact message
\invalid outcome''.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\NormalTok{rankhospital <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(state, outcome, rank) \{}
\NormalTok{        ## Read outcome data}
\NormalTok{        data <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"outcome-of-care-measures.csv"}\NormalTok{,}\DataTypeTok{colClasses =} \StringTok{"character"}\NormalTok{) }
        
\NormalTok{        data<-}\StringTok{ }\KeywordTok{select}\NormalTok{(data,}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{17}\NormalTok{,}\DecValTok{23}\NormalTok{)) }\CommentTok{#subset for hospital, state, heart attack, heart failure and pneumonia}
        \KeywordTok{colnames}\NormalTok{(data) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)}
        \CommentTok{# Check that state and outcome are valid}
        
        \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\NormalTok{state }\OperatorTok{%in%}\StringTok{ }\NormalTok{data[ ,}\StringTok{"state"}\NormalTok{])}
\NormalTok{                \{ }\KeywordTok{stop}\NormalTok{(}\StringTok{'invalid state'}\NormalTok{)}
\NormalTok{        \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\NormalTok{outcome }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)) }
\NormalTok{                \{}\KeywordTok{stop}\NormalTok{(}\StringTok{'invalid outcome'}\NormalTok{)}
\NormalTok{        \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{is.numeric}\NormalTok{(rank))\{}
                
\NormalTok{                state_logical <-}\StringTok{ }\KeywordTok{which}\NormalTok{(data[, }\StringTok{"state"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\NormalTok{state) }\CommentTok{#logical variable for having state}
                
\NormalTok{                df_state <-}\StringTok{ }\NormalTok{data[state_logical, ]    }\CommentTok{# subset data for having state}
       
\NormalTok{                df_state[,}\KeywordTok{eval}\NormalTok{(outcome)] <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(df_state[, }\KeywordTok{eval}\NormalTok{(outcome)])}
        
\NormalTok{                df_state <-}\StringTok{ }\NormalTok{df_state[}\KeywordTok{order}\NormalTok{(df_state[, }\KeywordTok{eval}\NormalTok{(outcome)], df_state[, }\StringTok{"hospital"}\NormalTok{]), ]}

\NormalTok{                output  <-}\StringTok{ }\NormalTok{df_state[,}\StringTok{"hospital"}\NormalTok{][rank]}
               
                
\NormalTok{        \}}
          \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\KeywordTok{is.numeric}\NormalTok{(rank))\{}
                \ControlFlowTok{if}\NormalTok{ (rank }\OperatorTok{==}\StringTok{ "best"}\NormalTok{) \{}
                
\NormalTok{                output<-}\StringTok{ }\KeywordTok{best}\NormalTok{(state,outcome)}
        
\NormalTok{        \}       }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (rank }\OperatorTok{==}\StringTok{ "worst"}\NormalTok{) \{}
                
\NormalTok{                state_logical <-}\StringTok{ }\KeywordTok{which}\NormalTok{(data[, }\StringTok{"state"}\NormalTok{]}\OperatorTok{==}\NormalTok{state)}
                
\NormalTok{                df_state <-data[state_logical,]}
                
\NormalTok{                df_state[, }\KeywordTok{eval}\NormalTok{(outcome)] <-}\KeywordTok{as.numeric}\NormalTok{(df_state[,}\KeywordTok{eval}\NormalTok{(outcome)]) }\CommentTok{#turn the outcome value into numeric}
               
\NormalTok{                df_state <-}\StringTok{ }\NormalTok{df_state[}\KeywordTok{order}\NormalTok{(df_state[,}\KeywordTok{eval}\NormalTok{(outcome)], df_state[,}\StringTok{"hospital"}\NormalTok{], }\DataTypeTok{decreasing =}\NormalTok{T),] }\CommentTok{#order the hospital: if some hospital have same values, use alphabetically order}
                
\NormalTok{                output <-}\StringTok{ }\NormalTok{df_state[,}\StringTok{"hospital"}\NormalTok{][}\DecValTok{1}\NormalTok{] }\CommentTok{#only return the first one}
\NormalTok{        \}}
                \ControlFlowTok{else} 
\NormalTok{                \{}\KeywordTok{stop}\NormalTok{(}\StringTok{"invalid rank"}\NormalTok{)}
\NormalTok{        \}}
                
        
\NormalTok{                \}}
        
\KeywordTok{return}\NormalTok{(output)     }
\NormalTok{\}}
        
\KeywordTok{rankhospital}\NormalTok{(}\StringTok{"NC"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{, }\StringTok{"worst"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in rankhospital("NC", "heart attack", "worst"): NAs introduced by
## coercion
\end{verbatim}

\begin{verbatim}
## [1] "WAYNE MEMORIAL HOSPITAL"
\end{verbatim}

\subsection{Part 3: Ranking hospitals in all
states}\label{part-3-ranking-hospitals-in-all-states}

Write a function called rankall that takes two arguments: an outcome
name (outcome) and a hospital rank- ing (num). The function reads the
outcome-of-care-measures.csv file and returns a 2-column data frame
containing the hospital in each state that has the ranking specified in
num. For example the function call rankall(``heart attack'', ``best'')
would return a data frame containing the names of the hospitals that are
the best in their respective states for 30-day heart attack death rates.
The function should return a value for every state (some may be NA). The
first column in the data frame is named hospital, which contains the
hospital name, and the second column is named state, which contains the
2-character abbreviation for the state name. Hospitals that do not have
data on a particular outcome should be excluded from the set of
hospitals when deciding the rankings.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\NormalTok{rankall <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(outcome, }\DataTypeTok{num =} \StringTok{"best"}\NormalTok{) \{}
        
        \CommentTok{#test}
        
\NormalTok{        outcome=}\StringTok{ "heart attack"}
\NormalTok{        ## Read outcome data}
\NormalTok{        data <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"outcome-of-care-measures.csv"}\NormalTok{,}\DataTypeTok{colClasses =} \StringTok{"character"}\NormalTok{) }
        
\NormalTok{        data<-}\StringTok{ }\KeywordTok{select}\NormalTok{(data,}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{17}\NormalTok{,}\DecValTok{23}\NormalTok{))}
        \KeywordTok{colnames}\NormalTok{(data)<-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)}
       
\NormalTok{        disease <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"heart attack"}\NormalTok{, }\StringTok{"heart failure"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)}
        
        
        \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\NormalTok{outcome }\OperatorTok{%in%}\StringTok{ }\NormalTok{disease ) \{}\KeywordTok{stop}\NormalTok{ (}\StringTok{"invalid outcome"}\NormalTok{)\}}
        
        \ControlFlowTok{if}\NormalTok{ (outcome }\OperatorTok{==}\StringTok{ "heart attack"}\NormalTok{) \{}
\NormalTok{                data<-}\StringTok{ }\NormalTok{data[}\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{, }\StringTok{"heart attack"}\NormalTok{)]}
\NormalTok{        \}}
        \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (outcome }\OperatorTok{==}\StringTok{ "heart failure"}\NormalTok{) \{}
\NormalTok{                data<-}\StringTok{ }\NormalTok{data[}\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{,}\StringTok{"heart failure"}\NormalTok{)]}
\NormalTok{        \}}
        \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (outcome }\OperatorTok{==}\StringTok{ "pneumonia"}\NormalTok{) \{}
\NormalTok{                data<-}\StringTok{ }\NormalTok{data[}\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{,}\StringTok{"state"}\NormalTok{, }\StringTok{"pneumonia"}\NormalTok{)]}
\NormalTok{        \}}
        
       \KeywordTok{colnames}\NormalTok{(data)[}\DecValTok{3}\NormalTok{] <-}\StringTok{ "disease.rate"}

\NormalTok{        data}\OperatorTok{$}\NormalTok{disease.rate <-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(data}\OperatorTok{$}\NormalTok{disease.rate))}
        
\NormalTok{data}\OperatorTok{$}\NormalTok{hospital<-}\StringTok{ }\KeywordTok{as.character}\NormalTok{(data}\OperatorTok{$}\NormalTok{hospital)}
        
        \CommentTok{#transform for order using}
    
\NormalTok{        State_list <-}\StringTok{ }\KeywordTok{as.character}\NormalTok{((data}\OperatorTok{$}\NormalTok{state)) }
        
\NormalTok{        State_list <-}\StringTok{ }\NormalTok{State_list[}\KeywordTok{order}\NormalTok{(State_list)] }
        
\NormalTok{        final_df <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{() }\CommentTok{#create a blank df first}
        
        \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \KeywordTok{seq_len}\NormalTok{(}\KeywordTok{length}\NormalTok{(State_list)))\{}
                
                
\NormalTok{                State_df <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(data, state }\OperatorTok{==}\StringTok{ }\NormalTok{State_list[i])}
                
\NormalTok{                State_df <-}\StringTok{ }\NormalTok{State_df[}\KeywordTok{order}\NormalTok{(State_df}\OperatorTok{$}\NormalTok{disease.rate, State_df}\OperatorTok{$}\NormalTok{hospital),]}
            
\NormalTok{        N <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(State_df}\OperatorTok{$}\NormalTok{disease.rate))  }
        \ControlFlowTok{if}\NormalTok{ (num }\OperatorTok{==}\StringTok{"best"}\NormalTok{) \{ num <-}\StringTok{ }\DecValTok{1}\NormalTok{\}}
        \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (num }\OperatorTok{==}\StringTok{"worst"}\NormalTok{) \{num <-}\StringTok{ }\NormalTok{N\}}
        \ControlFlowTok{else}\NormalTok{\{\}}
        
        
\NormalTok{        hos <-}\StringTok{ }\NormalTok{State_df[num, }\StringTok{"hospital"}\NormalTok{]}
\NormalTok{        df1 <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(hos, State_list[i])}
        \KeywordTok{colnames}\NormalTok{(df1) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"hospital"}\NormalTok{, }\StringTok{"state"}\NormalTok{)}
\NormalTok{        result_df <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(final_df, df1)}
\NormalTok{        \}}
        
        \KeywordTok{return}\NormalTok{(result_df)}
\NormalTok{\}}
        
\KeywordTok{rankall}\NormalTok{(}\StringTok{"heart attack"}\NormalTok{, }\StringTok{"best"}\NormalTok{)       }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in rankall("heart attack", "best"): NAs introduced by coercion
\end{verbatim}

\begin{verbatim}
##                 hospital state
## 1 WYOMING MEDICAL CENTER    WY
\end{verbatim}

** Reference**

{[}{]}\url{https://rpubs.com/fhlgood/rw3a3}

{[}{]}\url{https://xmuxiaomo.github.io/2015/06/19/R-Programming-Assignment-3/}

{[}{]}\url{https://github.com/DanieleP/PA3-tutorial}

{[}{]}\url{https://www.cnblogs.com/yifeili/p/5437384.html}


\end{document}
